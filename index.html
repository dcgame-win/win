<head>
    <link rel="icon" href="https://i.ibb.co/Jt89VHG/logo.png" type="image/x-icon">
    <style>
        body {
            background-image: url('https://i.postimg.cc/MHbvKCDq/istockphoto-152049839-612x612.jpg');
            background-repeat: no-repeat;
            background-size: cover;
            color: #2c3e50;
            font-family: Arial, sans-serif;
            text-align: center;
            height: 100vh;
            margin: 0;
            padding: 0;
        }
        h1, h2 {
            color: #D4AF37;
        }
        #result {
            color: #fff;
            font-size: 24px;
            font-weight: bold;
            margin-top: 20px;
        }
        .dice {
            width: 200px;
            margin: 20px auto;
            position: relative;
        }
        #diceImg {
            width: 100%;
        }
        button {
            padding: 10px 20px;
            background-color: #27AE60;
            color: #ffffff;
            border: none;
            cursor: pointer;
            margin: 5px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #1E8449;
        }
        .betting-interface, .withdrawal-interface, .auth-interface, .history-interface {
            margin: 20px;
            background-color: rgba(255, 255, 255, 0.9);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 10px;
        }
        .balance-section {
            margin: 20px;
            font-size: 20px;
        }
        .input-group {
            margin: 10px 0;
        }
        .input-group input, .input-group select {
            background-color: #ECF0F1;
            color: #2c3e50;
            border: 1px solid #1abc9c;
            padding: 5px;
            border-radius: 5px;
        }
        .dropdown {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 1;
        }
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #27AE60;
            min-width: 160px;
            box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2);
            padding: 12px 16px;
            border-radius: 5px;
            color: #ffffff;
        }
        .dropdown:hover .dropdown-content {
            display: block;
        }
        #musicControls {
            position: fixed;
            bottom: 10px;
            left: 10px;
            background-color: rgba(255, 255, 255, 0.7);
            padding: 5px;
            border-radius: 5px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #playPauseBtn {
            font-size: 10px;
            padding: 4px 8px;
            background-color: #27AE60;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        #volumeSlider {
            width: 60px;
            margin: 5px 0;
        }
        #musicSelector {
            font-size: 10px;
            margin-top: 5px;
            width: 70px;
        }
        @keyframes roll {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        @media (max-width: 600px) {
            #musicControls {
                padding: 3px;
            }
            #playPauseBtn {
                font-size: 8px;
                padding: 3px 6px;
            }
            #volumeSlider {
                width: 50px;
            }
            #musicSelector {
                font-size: 8px;
                width: 60px;
            }
        }
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        .loading-spinner {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .custom-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #f0f0f0;
            border: 2px solid #3498db;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            max-width: 80%;
            text-align: center;
        }
        .custom-popup-content {
            margin-bottom: 20px;
        }
        .custom-popup-close {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
        }
        #downloadBtn {
            position: fixed;
            bottom: 10px;
            right: 10px;
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            z-index: 1000;
        }
        #downloadBtn:hover {
            background-color: #2980b9;
        }
        .history-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .history-table th, .history-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        .history-table th {
            background-color: #f2f2f2;
        }
        .history-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        /* Style for tiny email link */
        .tiny-email-link {
            position: absolute;
            bottom: 5px;
            right: 5px;
            font-size: 6px;
            color: #cccccc;
            text-decoration: none;
            opacity: 0.5;
            transition: opacity 0.3s;
        }

        .tiny-email-link:hover {
            opacity: 1;
            color: #666666;
        }

        /* Additional styles for About Us page */
        .about-interface {
            margin: 20px;
            background-color: rgba(255, 255, 255, 0.9);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 10px;
            text-align: left;
            max-width: 800px;
            margin: 20px auto;
            position: relative;
            min-height: 500px;
        }

        .about-interface h2, .about-interface h3 {
            color: #3498db;
            margin: 15px 0;
        }

        .about-interface p {
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .about-interface ul {
            margin-left: 20px;
            margin-bottom: 15px;
        }

        /* VIP Level Styles */
        .vip-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .vip-bronze {
            background: #cd7f32;
            color: white;
        }
        
        .vip-silver {
            background: linear-gradient(45deg, #C0C0C0, #E8E8E8);
            color: #333;
        }
        
        .vip-gold {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: white;
        }

        /* Jackpot Animation */
        @keyframes jackpotWin {
            0% { transform: scale(1); }
            50% { transform: scale(1.5); }
            100% { transform: scale(1); }
        }

        .jackpot-win {
            animation: jackpotWin 1s ease-in-out;
            color: gold !important;
            text-shadow: 0 0 10px gold;
        }

        /* Daily Bonus */
        .daily-bonus {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(45deg, #27AE60, #2ECC71);
            padding: 10px;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            z-index: 1000;
        }

        /* Leaderboard */
        .leaderboard {
            position: fixed;
            right: -300px;
            top: 50%;
            transform: translateY(-50%);
            width: 280px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 10px 0 0 10px;
            padding: 15px;
            transition: right 0.3s;
        }

        .leaderboard.show {
            right: 0;
        }

        .leaderboard-toggle {
            position: absolute;
            left: -30px;
            top: 50%;
            transform: translateY(-50%);
            background: #27AE60;
            color: white;
            padding: 10px;
            cursor: pointer;
            writing-mode: vertical-rl;
            text-orientation: mixed;
            border-radius: 5px 0 0 5px;
        }

        /* Jackpot Progress */
        .jackpot-progress {
            width: 100%;
            height: 20px;
            background: #eee;
            border-radius: 10px;
            margin: 10px 0;
            overflow: hidden;
        }

        .jackpot-fill {
            height: 100%;
            background: linear-gradient(45deg, #FFD700, #FFA500);
            width: 0%;
            transition: width 0.3s;
        }

        /* Dark Mode Styles */
        body.dark-mode {
            background-color: #1a1a1a;
            color: #ffffff;
        }

        /* Chat Box Styles */
        .chat-container {
            position: fixed;
            right: -300px;
            bottom: 80px;
            width: 280px;
            height: 400px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 10px 0 0 10px;
            transition: right 0.3s;
            display: flex;
            flex-direction: column;
            z-index: 1000;
        }

        .chat-container.show {
            right: 0;
        }

        .chat-toggle {
            position: absolute;
            left: -30px;
            top: 50%;
            transform: translateY(-50%);
            background: #27AE60;
            color: white;
            padding: 10px;
            cursor: pointer;
            writing-mode: vertical-rl;
            text-orientation: mixed;
            border-radius: 5px 0 0 5px;
        }

        .chat-messages {
            flex-grow: 1;
            overflow-y: auto;
            padding: 10px;
        }

        .chat-input {
            padding: 10px;
            border-top: 1px solid #ddd;
        }

        .chat-input input {
            width: 80%;
            padding: 5px;
        }

        .chat-input button {
            width: 18%;
            padding: 5px;
        }

        /* Dice Skin Shop */
        .dice-shop {
            position: fixed;
            left: -300px;
            top: 50%;
            transform: translateY(-50%);
            width: 280px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 0 10px 10px 0;
            padding: 15px;
            transition: left 0.3s;
        }

        .dice-shop.show {
            left: 0;
        }

        .dice-skin {
            display: inline-block;
            margin: 5px;
            padding: 5px;
            border: 1px solid #ddd;
            cursor: pointer;
        }

        .dice-skin.selected {
            border-color: #27AE60;
        }

        /* Dark Mode Toggle */
        .dark-mode-toggle {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 10px;
            background: #27AE60;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        /* Confetti Animation */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #f00;
            position: absolute;
            animation: confetti-fall 3s linear forwards;
        }

        @keyframes confetti-fall {
            0% { transform: translateY(-100vh) rotate(0deg); }
            100% { transform: translateY(100vh) rotate(720deg); }
        }

        /* Bet History Sidebar */
        .bet-history-sidebar {
            position: fixed;
            right: -250px;
            top: 50%;
            transform: translateY(-50%);
            width: 230px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 10px 0 0 10px;
            padding: 15px;
            transition: right 0.3s;
        }

        .bet-history-sidebar.show {
            right: 0;
        }

        /* Streak Bonus Display */
        .streak-bonus {
            position: fixed;
            top: 70px;
            right: 20px;
            background: linear-gradient(45deg, #27AE60, #2ECC71);
            padding: 10px;
            border-radius: 5px;
            color: white;
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .chat-container, .dice-shop, .bet-history-sidebar {
                width: 100%;
                max-width: 300px;
            }
            
            .daily-bonus, .streak-bonus {
                font-size: 14px;
                padding: 8px;
            }
        }
        
        /* Deposit Interface */
        .deposit-interface {
            display: none;
            margin: 20px;
            background-color: rgba(255, 255, 255, 0.9);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 10px;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
        }

        .deposit-interface h2 {
            margin-bottom: 20px;
        }

        .deposit-interface input {
            margin: 10px 0;
            padding: 8px;
            width: 200px;
        }

        .close-deposit {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #333;
        }
        
        /* Bet Amount Controls */
        .bet-controls {
            display: flex;
            justify-content: center;
            margin: 10px 0;
        }
        
        .bet-controls button {
            margin: 0 5px;
            font-weight: bold;
        }
        
        /* Profile Section */
        .profile-interface {
            display: none;
            margin: 20px;
            background-color: rgba(255, 255, 255, 0.9);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 10px;
            position: relative;
        }
        
        .profile-form {
            max-width: 400px;
            margin: 0 auto;
        }
        
        .profile-form input {
            width: 100%;
            padding: 8px;
            margin: 8px 0;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        
        .profile-section {
            margin-top: 20px;
            border-top: 1px solid #ddd;
            padding-top: 20px;
        }
    </style>
    <script src="https://js.paystack.co/v1/inline.js"></script>
</head>
<body>
    <div id="loadingOverlay" class="loading-overlay" style="display:none;">
        <div class="loading-spinner"></div>
    </div>

    <button class="dark-mode-toggle">ðŸŒ™</button>

    <div class="chat-container">
        <div class="chat-toggle">Chat</div>
        <div class="chat-messages"></div>
        <div class="chat-input">
            <input type="text" placeholder="Type message...">
            <button>Send</button>
        </div>
    </div>

    <div class="dice-shop">
        <h3>Dice Skins</h3>
        <div class="dice-skin" data-skin="default">Default</div>
        <div class="dice-skin" data-skin="gold">Gold (500 credits)</div>
        <div class="dice-skin" data-skin="crystal">Crystal (1000 credits)</div>
    </div>

    <div class="bet-history-sidebar">
        <h3>Recent Bets</h3>
        <div id="recentBets"></div>
    </div>

    <div class="streak-bonus" style="display: none;">
        Day Streak: <span id="streakCount">0</span>
    </div>

    <div id="authInterface" class="auth-interface">
        <h2>Welcome to Dice Roll Game</h2>
        <div id="loginForm">
            <h3>Login</h3>
            <form id="loginFormElement">
                <input type="email" name="email" placeholder="Email" required>
                <input type="password" name="password" placeholder="Password" required>
                <button type="submit">Login</button>
            </form>
            <p>Don't have an account? <a href="#" id="showSignup">Sign up</a></p>
            <p><a href="#" id="forgotPassword">Forgot Password?</a></p>
        </div>
        <div id="signupForm" style="display:none;">
            <h3>Sign Up</h3>
            <form id="signupFormElement">
                <input type="text" name="username" placeholder="Username" required>
                <input type="email" name="email" placeholder="Email" required>
                <input type="password" name="password" placeholder="Password" required>
                <input type="text" name="referralCode" placeholder="Referral Code (Optional)">
                <button type="submit">Sign Up</button>
            </form>
            <p>Already have an account? <a href="#" id="showLogin">Login</a></p>
        </div>
        <div id="forgotPasswordForm" style="display:none;">
            <h3>Reset Password</h3>
            <form id="resetPasswordForm">
                <input type="email" name="resetEmail" placeholder="Enter your email" required>
                <button type="submit">Reset Password</button>
            </form>
            <p><a href="#" id="backToLogin">Back to Login</a></p>
        </div>
    </div>

    <div id="gameInterface" style="display:none;">
        <h1>Dice Roll Game</h1>
        <div class="balance-section">
            <h2>Balance: <span id="balance">â‚¦100.00</span></h2>
        </div>
        <div class="betting-interface">
            <h2>Roll Dice</h2>
            <div class="input-group">
                <label for="betAmount">Bet Amount (â‚¦):</label>
                <input type="number" id="betAmount" min="10" step="1" value="10">
                <div class="bet-controls">
                    <button id="halfBetBtn">1/2</button>
                    <button id="doubleBetBtn">2x</button>
                    <button id="maxBetBtn">Max</button>
                </div>
            </div>
            <div class="input-group">
                <label for="betNumber">Choose a Number (1-6):</label>
                <input type="number" id="betNumber" min="1" max="6">
            </div>
            <button id="placeBetBtn">Roll Dice</button>
        </div>
        <div class="dice" style="margin-top: 20px;">
            <img src="https://i.postimg.cc/d0dt3QLT/output-onlinegiftools_(3).gif" alt="Dice Roll" id="diceImg" style="display: none;">
        </div>
        <div id="result"></div>
        <div class="dropdown">
          <button class="dropdown-btn" style="background-color: #7F8C8D; color: #fff;">Menu</button>
          <div class="dropdown-content">
              <button id="profileBtn">Profile</button>
              <button id="historyBtn">History</button>
              <button id="fiatWithdraw">Fiat Withdrawal</button>
              <button id="aboutUsBtn">About Us</button>
              <button id="logoutBtn">Logout</button>
              <div class="withdrawal-interface" id="fiatWithdrawForm" style="display: none;">
            <h2>Fiat Withdrawal</h2>
            <div class="input-group">
                <label for="fiatWithdrawAmount">Withdrawal Amount (â‚¦):</label>
                <input type="number" id="fiatWithdrawAmount" min="5000" step="1" placeholder="Minimum â‚¦5000">
            </div>
            <div class="input-group">
                <label for="bankSelect">Select Bank:</label>
                <select id="bankSelect">
                    <option value="">-- Select Bank --</option>
                    <option value="opay">OPay</option>
                    <option value="kuda">Kuda Bank</option>
                    <option value="palmpay">PalmPay</option>
                    <option value="moniepoint">Moniepoint</option>
                    <option value="gtb">Guaranty Trust Bank</option>
                    <option value="firstbank">First Bank</option>
                    <option value="uba">United Bank for Africa</option>
                    <option value="zenith">Zenith Bank</option>
                </select>
            </div>
            <div class="input-group">
                <label for="accountNumber">Account Number:</label>
                <input type="text" id="accountNumber" placeholder="Enter account number">
            </div>
            <div class="input-group">
                <label for="accountName">Account Name:</label>
                <input type="text" id="accountName" placeholder="Enter account name">
            </div>
            <button id="verifyAccount">Verify Account</button>
            <button id="confirmWithdraw" style="display: none;">Confirm Withdrawal</button>
        </div>
              <p>Crypto withdrawal is coming soon. Please use fiat withdrawal for your withdrawal and deposit.</p>
          </div>
        </div>
        <div id="deposit">
            <h2>Deposit Funds</h2>
            <p>Choose a payment method:</p>
            <button id="cryptoDeposit">Crypto Deposit</button>
            <button id="fiatDeposit">Fiat Deposit</button>
        </div>

        <div id="depositInterface" class="deposit-interface">
            <button class="close-deposit">&times;</button>
            <h2>Deposit Amount</h2>
            <input type="number" id="depositAmount" placeholder="Amount (â‚¦)" min="500" value="15000">
            <button id="confirmDeposit">Deposit Now</button>
        </div>

        <div id="musicControls">
            <button id="playPauseBtn">Play/Pause</button>
            <input type="range" id="volumeSlider" min="0" max="1" step="0.1" value="0.5">
            <select id="musicSelector">
                <option value="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3">Music 1</option>
                <option value="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3">Music 2</option>
                <option value="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3">Music 3</option>
                <option value="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-10.mp3">Music 4</option>
                <option value="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-12.mp3">Music 5</option>
            </select>
        </div>
        
        <!-- Add VIP Badge -->
        <div id="vipBadge" class="vip-badge"></div>
        
        <!-- Add Daily Bonus -->
        <div class="daily-bonus" id="dailyBonus">
            Claim Daily Bonus!
        </div>
        
        <!-- Add Leaderboard -->
        <div class="leaderboard" id="leaderboard">
            <div class="leaderboard-toggle">Leaderboard</div>
            <h3>Top Players</h3>
            <div id="leaderboardContent"></div>
        </div>
        
        <!-- Add Jackpot Progress -->
        <div class="jackpot-progress">
            <div class="jackpot-fill" id="jackpotFill"></div>
        </div>
        <div id="jackpotAmount">Current Jackpot: â‚¦0</div>
    </div>

    <div id="historyInterface" class="history-interface" style="display:none;">
        <h2>Activity History</h2>
        <div id="historyContent"></div>
        <button id="closeHistoryBtn">Close History</button>
    </div>

    <div id="profileInterface" class="profile-interface" style="display:none;">
        <h2>Profile Settings</h2>
        <div class="profile-form">
            <div class="input-group">
                <label for="profileUsername">Username:</label>
                <input type="text" id="profileUsername" disabled>
            </div>
            <div class="input-group">
                <label for="profileEmail">Email:</label>
                <input type="email" id="profileEmail">
            </div>
            <div class="profile-section">
                <h3>Change Password</h3>
                <div class="input-group">
                    <label for="currentPassword">Current Password:</label>
                    <input type="password" id="currentPassword">
                </div>
                <div class="input-group">
                    <label for="newPassword">New Password:</label>
                    <input type="password" id="newPassword">
                </div>
                <div class="input-group">
                    <label for="confirmPassword">Confirm New Password:</label>
                    <input type="password" id="confirmPassword">
                </div>
                <button id="updatePasswordBtn">Update Password</button>
            </div>
            <div class="profile-section">
                <h3>Referral Program</h3>
                <p>Share your referral code and earn â‚¦500 for every friend who signs up and makes a deposit!</p>
                <div class="input-group">
                    <label for="referralCodeDisplay">Your Referral Code:</label>
                    <input type="text" id="referralCodeDisplay" readonly>
                </div>
                <button id="copyReferralBtn">Copy Referral Code</button>
            </div>
            <button id="saveProfileBtn">Save Changes</button>
            <button id="closeProfileBtn">Close</button>
        </div>
    </div>

    <div id="aboutUsInterface" class="about-interface" style="display:none;">
        <h2>About Us - Dice Roll Game</h2>
        <p>Welcome to Dice Roll Game, the ultimate online betting experience where luck meets strategy! Our platform offers a fun and secure gaming environment, allowing users to deposit, bet, and withdraw their winnings seamlessly.</p>
        
        <h3>Our Mission</h3>
        <p>At Dice Roll Game, we aim to provide:</p>
        <ul>
            <li>A fair and transparent gaming system</li>
            <li>Fast and secure deposit and withdrawal methods</li>
            <li>A responsible gaming environment</li>
        </ul>

        <h3>Why Choose Us?</h3>
        <ul>
            <li>Provably Fair Gameplay: Every dice roll is random and cannot be manipulated.</li>
            <li>Instant Deposits: Secure transactions through trusted payment methods.</li>
            <li>24/7 Customer Support: Our team is always available to assist.</li>
            <li>Exciting Rewards: Earn referral bonuses, win bets, and enjoy promotions.</li>
        </ul>

        <h3>Responsible Gaming</h3>
        <p>We encourage responsible gaming. If you feel you need help managing your gaming habits, we provide tools to set deposit limits and self-exclude.</p>

        <a href="/cdn-cgi/l/email-protection#e881868e87c68c818b8d9a87848481868f8f89858da88f85898184c68b8785" class="tiny-email-link">Contact Support</a>
        <button id="closeAboutUsBtn">Close</button>
    </div>

    <button id="downloadBtn">Download App</button>

    <audio id="backgroundMusic" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" loop></audio>
    <audio id="loseSound" src="https://freesound.org/data/previews/76/76376_1079458-lq.mp3"></audio>
    <audio id="winSound" src="https://freesound.org/data/previews/456/456966_9482924-lq.mp3"></audio>
    <audio id="depositSuccessSound" src="https://freesound.org/data/previews/270/270404_5123851-lq.mp3"></audio>

    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
        const mockPlayers = [
            { username: "LuckyPro777", balance: 250000 },
            { username: "DiceKing456", balance: 180000 },
            { username: "RollMaster", balance: 150000 },
            { username: "BetWinner123", balance: 120000 },
            { username: "GameMaster99", balance: 100000 },
            { username: "DiceChamp", balance: 85000 },
            { username: "LuckyPlayer", balance: 75000 },
            { username: "BetExpert", balance: 65000 },
            { username: "RollExpert", balance: 55000 }
        ];

        document.addEventListener('DOMContentLoaded', function() {
            const authInterface = document.getElementById('authInterface');
            const gameInterface = document.getElementById('gameInterface');
            const historyInterface = document.getElementById('historyInterface');
            const aboutUsInterface = document.getElementById('aboutUsInterface');
            const profileInterface = document.getElementById('profileInterface');
            const loginForm = document.getElementById('loginForm');
            const signupForm = document.getElementById('signupForm');
            const forgotPasswordForm = document.getElementById('forgotPasswordForm');
            const showSignupLink = document.getElementById('showSignup');
            const showLoginLink = document.getElementById('showLogin');
            const forgotPasswordLink = document.getElementById('forgotPassword');
            const backToLoginLink = document.getElementById('backToLogin');
            const profileBtn = document.getElementById('profileBtn');
            const historyBtn = document.getElementById('historyBtn');
            const closeHistoryBtn = document.getElementById('closeHistoryBtn');
            const aboutUsBtn = document.getElementById('aboutUsBtn');
            const closeAboutUsBtn = document.getElementById('closeAboutUsBtn');
            const closeProfileBtn = document.getElementById('closeProfileBtn');
            const logoutBtn = document.getElementById('logoutBtn');
            const rollBtn = document.getElementById('rollBtn');
            const diceImg = document.getElementById('diceImg');
            const resultDiv = document.getElementById('result');
            const placeBetBtn = document.getElementById('placeBetBtn');
            const betAmountInput = document.getElementById('betAmount');
            const betNumberInput = document.getElementById('betNumber');
            const balanceSpan = document.getElementById('balance');
            const cryptoDepositBtn = document.getElementById('cryptoDeposit');
            const fiatDepositBtn = document.getElementById('fiatDeposit');
            const confirmDepositBtn = document.getElementById('confirmDeposit');
            const depositAmountInput = document.getElementById('depositAmount');
            const fiatWithdrawBtn = document.getElementById('fiatWithdraw');
            const fiatWithdrawForm = document.getElementById('fiatWithdrawForm');
            const fiatWithdrawAmountInput = document.getElementById('fiatWithdrawAmount');
            const bankSelect = document.getElementById('bankSelect');
            const accountNumberInput = document.getElementById('accountNumber');
            const accountNameInput = document.getElementById('accountName');
            const verifyAccountBtn = document.getElementById('verifyAccount');
            const confirmWithdrawBtn = document.getElementById('confirmWithdraw');
            const loadingOverlay = document.getElementById('loadingOverlay');
            const downloadBtn = document.getElementById('downloadBtn');
            const resetPasswordForm = document.getElementById('resetPasswordForm');
            const loginFormElement = document.getElementById('loginFormElement');
            const signupFormElement = document.getElementById('signupFormElement');
            const halfBetBtn = document.getElementById('halfBetBtn');
            const doubleBetBtn = document.getElementById('doubleBetBtn');
            const maxBetBtn = document.getElementById('maxBetBtn');
            const profileUsername = document.getElementById('profileUsername');
            const profileEmail = document.getElementById('profileEmail');
            const currentPassword = document.getElementById('currentPassword');
            const newPassword = document.getElementById('newPassword');
            const confirmPassword = document.getElementById('confirmPassword');
            const updatePasswordBtn = document.getElementById('updatePasswordBtn');
            const referralCodeDisplay = document.getElementById('referralCodeDisplay');
            const copyReferralBtn = document.getElementById('copyReferralBtn');
            const saveProfileBtn = document.getElementById('saveProfileBtn');

            const backgroundMusic = document.getElementById('backgroundMusic');
            const loseSound = document.getElementById('loseSound');
            const winSound = document.getElementById('winSound');
            const depositSuccessSound = document.getElementById('depositSuccessSound');

            const playPauseBtn = document.getElementById('playPauseBtn');
            const volumeSlider = document.getElementById('volumeSlider');
            const musicSelector = document.getElementById('musicSelector');

            let balance = 100;
            let isLoggedIn = false;
            let currentUser = null;

            // Check for active login session when page loads
            function checkLoginSession() {
                const sessionUser = localStorage.getItem('currentUser');
                if (sessionUser) {
                    try {
                        currentUser = JSON.parse(sessionUser);
                        if (currentUser && currentUser.email) {
                            isLoggedIn = true;
                            balance = currentUser.balance || 100;
                            showGame();
                            updateVIPStatus();
                            updateLeaderboard();
                        }
                    } catch (e) {
                        console.error("Error parsing stored user data", e);
                        localStorage.removeItem('currentUser');
                    }
                }
            }

            function updateBalance(amount) {
                balance += amount;
                balanceSpan.textContent = `â‚¦${balance.toFixed(2)}`;
                if (currentUser) {
                    currentUser.balance = balance;
                    localStorage.setItem(currentUser.email, JSON.stringify(currentUser));
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                }
            }

            function generateReferralCode() {
                return Math.random().toString(36).substring(2, 8).toUpperCase();
            }

            function showGame() {
                loadingOverlay.style.display = 'flex';
                setTimeout(() => {
                    authInterface.style.display = 'none';
                    gameInterface.style.display = 'block';
                    historyInterface.style.display = 'none';
                    aboutUsInterface.style.display = 'none';
                    profileInterface.style.display = 'none';
                    loadingOverlay.style.display = 'none';
                    updateBalance(0);
                    checkDailyBonus();
                }, 1000);
            }

            function showAuth() {
                authInterface.style.display = 'block';
                gameInterface.style.display = 'none';
                historyInterface.style.display = 'none';
                aboutUsInterface.style.display = 'none';
                profileInterface.style.display = 'none';
            }

            function showCustomPopup(message) {
                const popup = document.createElement('div');
                popup.className = 'custom-popup';
                popup.innerHTML = `
                    <div class="custom-popup-content">${message}</div>
                    <button class="custom-popup-close">Close</button>
                `;
                document.body.appendChild(popup);
                popup.querySelector('.custom-popup-close').addEventListener('click', () => {
                    document.body.removeChild(popup);
                });
            }

            function addToHistory(action, amount, details) {
                if (!currentUser) return;
                
                let history = JSON.parse(localStorage.getItem(`${currentUser.email}_history`)) || [];
                history.push({
                    action,
                    amount,
                    details,
                    timestamp: new Date().toISOString()
                });
                localStorage.setItem(`${currentUser.email}_history`, JSON.stringify(history));
            }

            function displayHistory() {
                if (!currentUser) return;
                
                let history = JSON.parse(localStorage.getItem(`${currentUser.email}_history`)) || [];
                let historyContent = document.getElementById('historyContent');
                if (history.length === 0) {
                    historyContent.innerHTML = '<p>No activity history available.</p>';
                } else {
                    let tableHTML = `
                        <table class="history-table">
                            <tr>
                                <th>Date</th>
                                <th>Action</th>
                                <th>Amount</th>
                                <th>Details</th>
                            </tr>
                    `;
                    history.forEach(item => {
                        tableHTML += `
                            <tr>
                                <td>${new Date(item.timestamp).toLocaleString()}</td>
                                <td>${item.action}</td>
                                <td>â‚¦${item.amount.toFixed(2)}</td>
                                <td>${item.details}</td>
                            </tr>
                        `;
                    });
                    tableHTML += '</table>';
                    historyContent.innerHTML = tableHTML;
                }
            }
            
            function loadProfileData() {
                if (!currentUser) return;
                
                profileUsername.value = currentUser.username;
                profileEmail.value = currentUser.email;
                referralCodeDisplay.value = currentUser.referralCode;
            }
            
            // Bet amount controls
            halfBetBtn.addEventListener('click', () => {
                const currentBet = parseFloat(betAmountInput.value);
                if (!isNaN(currentBet)) {
                    betAmountInput.value = (currentBet / 2).toFixed(2);
                }
            });
            
            doubleBetBtn.addEventListener('click', () => {
                const currentBet = parseFloat(betAmountInput.value);
                if (!isNaN(currentBet)) {
                    betAmountInput.value = (currentBet * 2).toFixed(2);
                }
            });
            
            maxBetBtn.addEventListener('click', () => {
                betAmountInput.value = balance.toFixed(2);
            });

            if (showSignupLink) {
                showSignupLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    loginForm.style.display = 'none';
                    signupForm.style.display = 'block';
                });
            }

            if (showLoginLink) {
                showLoginLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    signupForm.style.display = 'none';
                    loginForm.style.display = 'block';
                });
            }

            loginFormElement.addEventListener('submit', (e) => {
                e.preventDefault();
                const email = e.target.email.value;
                const password = e.target.password.value;
                
                // Check if user exists
                const userData = localStorage.getItem(email);
                if (userData) {
                    const user = JSON.parse(userData);
                    if (user.password === password) {
                        if (user.deleted) {
                            showCustomPopup('This account has been deleted. Please sign up again.');
                            return;
                        }
                        
                        currentUser = user;
                        balance = user.balance || 100;
                        isLoggedIn = true;
                        
                        // Save current login session
                        localStorage.setItem('currentUser', JSON.stringify(currentUser));
                        
                        showGame();
                        updateLeaderboard();
                        checkDailyBonus();
                    } else {
                        showCustomPopup('Invalid password. Please try again.');
                    }
                } else {
                    showCustomPopup('No account found with this email address.');
                }
            });

            signupFormElement.addEventListener('submit', (e) => {
                e.preventDefault();
                const username = e.target.username.value;
                const email = e.target.email.value;
                const password = e.target.password.value;
                const referralCode = e.target.referralCode.value;
                
                // Check if email already exists
                const existingUser = localStorage.getItem(email);
                if (existingUser) {
                    const user = JSON.parse(existingUser);
                    if (!user.deleted) {
                        showCustomPopup('An account with this email already exists. Please login instead.');
                        return;
                    }
                }
                
                const newUser = {
                    username,
                    email,
                    password,
                    referralCode: generateReferralCode(),
                    balance: 100,
                    referredBy: referralCode || null,
                    deleted: false
                };
                
                localStorage.setItem(email, JSON.stringify(newUser));
                
                // Check referral code and add bonus after deposit
                if (referralCode) {
                    // Store referral info for later processing after deposit
                    localStorage.setItem(`referral_${email}`, referralCode);
                }
                
                currentUser = newUser;
                balance = newUser.balance;
                isLoggedIn = true;
                
                // Save current login session
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                addToHistory('Sign Up', 100, 'Initial balance');
                showGame();
                updateLeaderboard();
                checkDailyBonus();
                
                // Show popup about referral program
                if (referralCode) {
                    showCustomPopup('Thank you for signing up! Your referee will receive â‚¦500 bonus after you make your first deposit.');
                }
            });

            forgotPasswordLink.addEventListener('click', (e) => {
                e.preventDefault();
                loginForm.style.display = 'none';
                signupForm.style.display = 'none';
                forgotPasswordForm.style.display = 'block';
            });

            backToLoginLink.addEventListener('click', (e) => {
                e.preventDefault();
                forgotPasswordForm.style.display = 'none';
                loginForm.style.display = 'block';
            });

            resetPasswordForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const email = e.target.resetEmail.value;
                const userData = localStorage.getItem(email);
                
                if (userData) {
                    const user = JSON.parse(userData);
                    if (user.deleted) {
                        showCustomPopup('This account has been deleted. Please sign up again.');
                        return;
                    }
                    
                    // Generate temporary password
                    const tempPassword = Math.random().toString(36).slice(-8);
                    user.password = tempPassword;
                    localStorage.setItem(email, JSON.stringify(user));
                    
                    // In a real application, you would send this via email
                    // For demo purposes, we'll show it in a popup
                    showCustomPopup(`A temporary password has been generated for your account: ${tempPassword}<br><br>Please use this to login and change your password immediately in the profile section.`);
                    
                    forgotPasswordForm.style.display = 'none';
                    loginForm.style.display = 'block';
                } else {
                    showCustomPopup('No account found with this email address.');
                }
            });

            profileBtn.addEventListener('click', () => {
                if (currentUser) {
                    gameInterface.style.display = 'none';
                    profileInterface.style.display = 'block';
                    loadProfileData();
                }
            });
            
            closeProfileBtn.addEventListener('click', () => {
                profileInterface.style.display = 'none';
                gameInterface.style.display = 'block';
            });
            
            copyReferralBtn.addEventListener('click', () => {
                referralCodeDisplay.select();
                document.execCommand('copy');
                showCustomPopup('Referral code copied to clipboard! Share with friends to earn â‚¦500 for each referral that deposits.');
            });
            
            updatePasswordBtn.addEventListener('click', () => {
                if (!currentUser) return;
                
                const currentPwd = currentPassword.value;
                const newPwd = newPassword.value;
                const confirmPwd = confirmPassword.value;
                
                if (!currentPwd || !newPwd || !confirmPwd) {
                    showCustomPopup('Please fill in all password fields.');
                    return;
                }
                
                if (currentPwd !== currentUser.password) {
                    showCustomPopup('Current password is incorrect.');
                    return;
                }
                
                if (newPwd !== confirmPwd) {
                    showCustomPopup('New passwords do not match.');
                    return;
                }
                
                // Update password
                currentUser.password = newPwd;
                localStorage.setItem(currentUser.email, JSON.stringify(currentUser));
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                showCustomPopup('Password updated successfully!');
                
                // Clear fields
                currentPassword.value = '';
                newPassword.value = '';
                confirmPassword.value = '';
            });
            
            saveProfileBtn.addEventListener('click', () => {
                if (!currentUser) return;
                
                const newEmail = profileEmail.value;
                
                if (!newEmail || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(newEmail)) {
                    showCustomPopup('Please enter a valid email address.');
                    return;
                }
                
                if (newEmail !== currentUser.email) {
                    // Check if new email already exists
                    if (localStorage.getItem(newEmail)) {
                        showCustomPopup('This email is already in use by another account.');
                        return;
                    }
                    
                    // Save user data with new email
                    const userData = JSON.stringify(currentUser);
                    localStorage.removeItem(currentUser.email);
                    
                    currentUser.email = newEmail;
                    localStorage.setItem(newEmail, JSON.stringify(currentUser));
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    
                    showCustomPopup('Email updated successfully!');
                }
            });

            historyBtn.addEventListener('click', () => {
                gameInterface.style.display = 'none';
                historyInterface.style.display = 'block';
                aboutUsInterface.style.display = 'none';
                profileInterface.style.display = 'none';
                displayHistory();
            });

            closeHistoryBtn.addEventListener('click', () => {
                historyInterface.style.display = 'none';
                gameInterface.style.display = 'block';
                aboutUsInterface.style.display = 'none';
            });

            aboutUsBtn.addEventListener('click', () => {
                gameInterface.style.display = 'none';
                historyInterface.style.display = 'none';
                aboutUsInterface.style.display = 'block';
                profileInterface.style.display = 'none';
            });

            closeAboutUsBtn.addEventListener('click', () => {
                aboutUsInterface.style.display = 'none';
                gameInterface.style.display = 'block';
            });

            logoutBtn.addEventListener('click', () => {
                isLoggedIn = false;
                localStorage.removeItem('currentUser');
                currentUser = null;
                balance = 100;
                showAuth();
                showCustomPopup('You have been logged out successfully.');
            });

            const gameConfig = {
                standardPayout: 5.5, // Instead of 6x
                jackpotChance: 0.002, // 1 in 500 chance
                jackpotMultiplier: 100,
                withdrawalFee: 0.02, // 2%
                vipLevels: {
                    bronze: { minBets: 10, payoutBonus: 0.1 },
                    silver: { minBets: 50, payoutBonus: 0.2 },
                    gold: { minBets: 100, payoutBonus: 0.3 }
                }
            };

            placeBetBtn.addEventListener('click', () => {
                if (!isLoggedIn) {
                    showCustomPopup('Please log in to play');
                    return;
                }
                let betAmount = parseFloat(betAmountInput.value);
                let betNumber = parseInt(betNumberInput.value);

                if (isNaN(betAmount) || betAmount < 10) {
                    showCustomPopup('Please enter a valid bet amount (â‚¦10 minimum).');
                    return;
                }

                if (isNaN(betNumber) || betNumber < 1 || betNumber > 6) {
                    showCustomPopup('Please choose a number between 1 and 6.');
                    return;
                }

                if (betAmount > balance) {
                    showCustomPopup('Insufficient balance.');
                    return;
                }

                updateBalance(-betAmount);
                addToHistory('Bet', -betAmount, `Bet on number ${betNumber}`);

                // Update bet count for VIP status
                const bets = parseInt(localStorage.getItem(`${currentUser.email}_bets`) || '0') + 1;
                localStorage.setItem(`${currentUser.email}_bets`, bets.toString());

                // Calculate jackpot chance
                const jackpotRoll = Math.random();
                const isJackpot = jackpotRoll < gameConfig.jackpotChance;

                diceImg.style.display = 'block';
                diceImg.style.animation = 'roll 2s infinite';
                resultDiv.textContent = 'Rolling dice...';
                
                setTimeout(() => {
                    let diceResult = Math.floor(Math.random() * 6) + 1;
                    diceImg.style.display = 'none';
                    diceImg.style.animation = '';
                    
                    if (isJackpot) {
                        // Jackpot win
                        const jackpotWin = betAmount * gameConfig.jackpotMultiplier;
                        resultDiv.textContent = `JACKPOT! You won â‚¦${jackpotWin}!`;
                        resultDiv.classList.add('jackpot-win');
                        updateBalance(jackpotWin);
                        addToHistory('Jackpot Win', jackpotWin, `Jackpot win on roll ${diceResult}`);
                        winSound.play();
                        createConfetti();
                    } else if (diceResult === betNumber) {
                        // Regular win
                        const payout = betAmount * (gameConfig.standardPayout + getVIPBonus());
                        resultDiv.textContent = `Won - you rolled ${diceResult}`;
                        resultDiv.style.color = '#2ecc71';
                        updateBalance(payout);
                        addToHistory('Win', payout, `Won on number ${diceResult}`);
                        winSound.play();
                    } else {
                        resultDiv.textContent = `Lost - you rolled ${diceResult}`;
                        resultDiv.style.color = '#e74c3c';
                        loseSound.play();
                    }

                    // Update streak status
                    updateStreak();
                    
                    // Update VIP status
                    updateVIPStatus();
                    updateLeaderboard();
                    updateBetHistory({
                        amount: betAmount,
                        result: diceResult,
                        win: diceResult === betNumber || isJackpot
                    });
                }, 2000);
            });

            function getVIPBonus() {
                const bets = parseInt(localStorage.getItem(`${currentUser.email}_bets`) || '0');
                if (bets >= gameConfig.vipLevels.gold.minBets) return gameConfig.vipLevels.gold.payoutBonus;
                if (bets >= gameConfig.vipLevels.silver.minBets) return gameConfig.vipLevels.silver.payoutBonus;
                if (bets >= gameConfig.vipLevels.bronze.minBets) return gameConfig.vipLevels.bronze.payoutBonus;
                return 0;
            }

            function updateVIPStatus() {
                if (!currentUser) return;
                
                const bets = parseInt(localStorage.getItem(`${currentUser.email}_bets`) || '0');
                const vipBadge = document.getElementById('vipBadge');
                
                if (bets >= gameConfig.vipLevels.gold.minBets) {
                    vipBadge.className = 'vip-badge vip-gold';
                    vipBadge.textContent = 'VIP GOLD';
                } else if (bets >= gameConfig.vipLevels.silver.minBets) {
                    vipBadge.className = 'vip-badge vip-silver';
                    vipBadge.textContent = 'VIP SILVER';
                } else if (bets >= gameConfig.vipLevels.bronze.minBets) {
                    vipBadge.className = 'vip-badge vip-bronze';
                    vipBadge.textContent = 'VIP BRONZE';
                } else {
                    vipBadge.className = 'vip-badge';
                    vipBadge.textContent = '';
                }
            }

            const dailyBonus = document.getElementById('dailyBonus');
            
            function checkDailyBonus() {
                if (!currentUser) return;
                
                const lastClaim = localStorage.getItem(`${currentUser.email}_lastBonus`);
                const today = new Date().toDateString();
                
                if (lastClaim !== today) {
                    dailyBonus.style.display = 'block';
                } else {
                    dailyBonus.style.display = 'none';
                }
            }

            dailyBonus.addEventListener('click', () => {
                if (!currentUser) return;
                
                const lastClaim = localStorage.getItem(`${currentUser.email}_lastBonus`);
                const today = new Date().toDateString();
                
                if (lastClaim !== today) {
                    updateBalance(100);
                    localStorage.setItem(`${currentUser.email}_lastBonus`, today);
                    addToHistory('Daily Bonus', 100, 'Daily login bonus claimed');
                    showCustomPopup('Daily bonus of â‚¦100 claimed!');
                    dailyBonus.style.display = 'none';
                    updateLeaderboard();
                }
            });

            function updateLeaderboard() {
                const leaderboardContent = document.getElementById('leaderboardContent');
                let leaderboardHTML = '';
                
                // Add current user if logged in
                let allPlayers = [...mockPlayers];
                if (currentUser) {
                    allPlayers.push({
                        username: currentUser.username,
                        balance: balance
                    });
                }
                
                // Sort players by balance
                allPlayers.sort((a, b) => b.balance - a.balance);
                
                // Display top 10 players
                allPlayers.slice(0, 10).forEach((player, index) => {
                    const formattedBalance = new Intl.NumberFormat('en-NG', {
                        style: 'currency',
                        currency: 'NGN',
                        minimumFractionDigits: 2
                    }).format(player.balance);
                    
                    const isCurrentUser = currentUser && player.username === currentUser.username;
                    const playerStyle = isCurrentUser ? 'color: #27AE60; font-weight: bold;' : '';
                    
                    leaderboardHTML += `
                        <div style="margin: 5px 0; ${playerStyle}">
                            ${index + 1}. ${player.username} - ${formattedBalance}
                        </div>
                    `;
                });
                
                leaderboardContent.innerHTML = leaderboardHTML;
            }

            document.querySelector('.leaderboard-toggle').addEventListener('click', () => {
                document.getElementById('leaderboard').classList.toggle('show');
            });

            fiatWithdrawBtn.addEventListener('click', () => {
                fiatWithdrawForm.style.display = 'block';
            });

            verifyAccountBtn.addEventListener('click', () => {
                let withdrawalAmount = parseFloat(fiatWithdrawAmountInput.value);
                let bank = bankSelect.value;
                let accountNumber = accountNumberInput.value;
                let accountName = accountNameInput.value;

                if (isNaN(withdrawalAmount) || withdrawalAmount < 5000) {
                    showCustomPopup('Please enter a valid withdrawal amount (â‚¦5000 minimum).');
                    return;
                }

                if (withdrawalAmount > balance) {
                    showCustomPopup('Insufficient balance for withdrawal.');
                    return;
                }

                if (!bank || !accountNumber || !accountName) {
                    showCustomPopup('Please fill in all fields.');
                    return;
                }

                confirmWithdrawBtn.style.display = 'block';
            });

            confirmWithdrawBtn.addEventListener('click', () => {
                let withdrawalAmount = parseFloat(fiatWithdrawAmountInput.value);
                let bank = bankSelect.value;
                let accountNumber = accountNumberInput.value;
                let accountName = accountNameInput.value;

                // Simulate a withdrawal process
                loadingOverlay.style.display = 'flex';
                
                setTimeout(() => {
                    loadingOverlay.style.display = 'none';
                    showCustomPopup('Withdrawal successful. Processing within 24 hours.');
                    updateBalance(-withdrawalAmount);
                    addToHistory('Withdrawal', -withdrawalAmount, `Withdrawal to ${bank} - ${accountNumber}`);
                    updateLeaderboard();
                    
                    // Reset form
                    fiatWithdrawForm.style.display = 'none';
                    fiatWithdrawAmountInput.value = '';
                    bankSelect.value = '';
                    accountNumberInput.value = '';
                    accountNameInput.value = '';
                    confirmWithdrawBtn.style.display = 'none';
                }, 2000);
            });

            fiatDepositBtn.addEventListener('click', () => {
                const depositInterface = document.getElementById('depositInterface');
                depositInterface.style.display = depositInterface.style.display === 'block' ? 'none' : 'block';
            });

            document.querySelector('.close-deposit').addEventListener('click', () => {
                document.getElementById('depositInterface').style.display = 'none';
            });

            confirmDepositBtn.addEventListener('click', () => {
                let depositAmount = parseFloat(document.getElementById('depositAmount').value);
                if (isNaN(depositAmount) || depositAmount < 500) {
                    showCustomPopup('Please enter a valid deposit amount (â‚¦500 minimum).');
                    return;
                }
                document.getElementById('depositInterface').style.display = 'none';
                
                // Check if this is a first deposit and there's a referral code
                const referralCode = localStorage.getItem(`referral_${currentUser.email}`);
                
                loadingOverlay.style.display = 'flex';
                
                setTimeout(() => {
                    loadingOverlay.style.display = 'none';
                    
                    // Process referral bonus after deposit
                    if (referralCode) {
                        processReferralBonus(referralCode);
                        localStorage.removeItem(`referral_${currentUser.email}`);
                    }
                    
                    updateBalance(depositAmount);
                    addToHistory('Deposit', depositAmount, `Deposit via Paystack`);
                    showCustomPopup('Deposit successful!');
                    depositSuccessSound.play();
                    updateLeaderboard();
                }, 2000);
            });
            
            function processReferralBonus(referralCode) {
                // Find referrer by referral code
                let referrerFound = false;
                
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key && !key.includes('_')) {
                        try {
                            const userData = JSON.parse(localStorage.getItem(key));
                            if (userData && userData.referralCode === referralCode) {
                                // Add bonus to referrer
                                userData.balance += 500; // â‚¦500 bonus
                                localStorage.setItem(key, JSON.stringify(userData));
                                
                                // Add history record for referrer
                                let referrerHistory = JSON.parse(localStorage.getItem(`${userData.email}_history`)) || [];
                                referrerHistory.push({
                                    action: 'Referral Bonus',
                                    amount: 500,
                                    details: `Bonus for referring ${currentUser.username}`,
                                    timestamp: new Date().toISOString()
                                });
                                localStorage.setItem(`${userData.email}_history`, JSON.stringify(referrerHistory));
                                
                                referrerFound = true;
                                break;
                            }
                        } catch (e) {
                            // Skip invalid entries
                        }
                    }
                }
                
                if (referrerFound) {
                    showCustomPopup('Referral bonus of â‚¦500 has been credited to your referee!');
                }
            }

            downloadBtn.addEventListener('click', function() {
                const apkUrl = 'https://apk.e-droid.net/apk/app3211285-pdjx7f.apk?v=5';
                
                // Create a temporary anchor element
                const downloadLink = document.createElement('a');
                downloadLink.href = apkUrl;
                downloadLink.download = 'DiceRollGame.apk'; // Suggested filename
                downloadLink.target = '_blank'; // Open in new tab
                
                // Trigger download
                document.body.appendChild(downloadLink);
                downloadLink.click();
                document.body.removeChild(downloadLink);
                
                // Show download started message
                showCustomPopup('Download started! If download doesn\'t begin automatically, please click the link again.');
            });

            playPauseBtn.addEventListener('click', () => {
                if (backgroundMusic.paused) {
                    backgroundMusic.play();
                } else {
                    backgroundMusic.pause();
                }
            });

            volumeSlider.addEventListener('input', () => {
                backgroundMusic.volume = volumeSlider.value;
            });

            musicSelector.addEventListener('change', () => {
                backgroundMusic.src = musicSelector.value;
                backgroundMusic.play();
            });
            
            function updateBetHistory(bet) {
                const recentBets = document.getElementById('recentBets');
                const betItem = document.createElement('div');
                betItem.style.margin = '5px 0';
                betItem.style.padding = '5px';
                betItem.style.borderBottom = '1px solid #eee';
                
                betItem.innerHTML = `
                    <div>Amount: â‚¦${bet.amount.toFixed(2)}</div>
                    <div>Result: ${bet.result}</div>
                    <div style="color: ${bet.win ? '#2ecc71' : '#e74c3c'}">${bet.win ? 'Win' : 'Loss'}</div>
                `;
                
                // Keep only the last 10 bets
                if (recentBets.children.length >= 10) {
                    recentBets.removeChild(recentBets.firstChild);
                }
                
                recentBets.appendChild(betItem);
            }
            
            // Streak bonus handling
            function updateStreak() {
                if (!currentUser) return;
                
                const streak = parseInt(localStorage.getItem(`${currentUser.email}_streak`) || '0');
                const lastPlay = localStorage.getItem(`${currentUser.email}_lastPlay`);
                const today = new Date().toDateString();
                
                if (lastPlay === today) return;
                
                if (lastPlay === new Date(Date.now() - 86400000).toDateString()) {
                    // Consecutive day
                    const newStreak = streak + 1;
                    localStorage.setItem(`${currentUser.email}_streak`, newStreak);
                    
                    if (newStreak % 5 === 0) {
                        // Bonus for every 5-day streak
                        updateBalance(500);
                        addToHistory('Streak Bonus', 500, `${newStreak}-day streak bonus`);
                        showCustomPopup(`${newStreak}-day Streak Bonus: â‚¦500 added!`);
                    }
                } else if (lastPlay) {
                    // Streak broken
                    localStorage.setItem(`${currentUser.email}_streak`, 1);
                } else {
                    // First time playing
                    localStorage.setItem(`${currentUser.email}_streak`, 1);
                }
                
                localStorage.setItem(`${currentUser.email}_lastPlay`, today);
                document.getElementById('streakCount').textContent = localStorage.getItem(`${currentUser.email}_streak`);
                
                // Show streak bonus indicator
                const streakCount = parseInt(localStorage.getItem(`${currentUser.email}_streak`) || '0');
                if (streakCount > 1) {
                    document.querySelector('.streak-bonus').style.display = 'block';
                }
            }

            // Confetti animation for big wins
            function createConfetti() {
                for(let i = 0; i < 100; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.backgroundColor = ['#ff0', '#f0f', '#0ff'][Math.floor(Math.random() * 3)];
                    document.body.appendChild(confetti);
                    setTimeout(() => confetti.remove(), 3000);
                }
            }

            // Check for login session when page loads
            checkLoginSession();
            
            // Dark mode toggle
            const darkModeToggle = document.querySelector('.dark-mode-toggle');
            darkModeToggle.addEventListener('click', () => {
                document.body.classList.toggle('dark-mode');
            });

            // Chat toggle
            document.querySelector('.chat-toggle').addEventListener('click', () => {
                document.querySelector('.chat-container').classList.toggle('show');
            });
            
            // Initialize chat with mock messages
            const chatMessages = document.querySelector('.chat-messages');
            const chatInput = document.querySelector('.chat-input input');
            const chatSendBtn = document.querySelector('.chat-input button');
            
            // Load saved chat messages or initialize with mock messages
            function initializeChat() {
                const savedMessages = JSON.parse(localStorage.getItem('chatMessages')) || [
                    { user: 'LuckyPlayer', message: 'Just won 5000!' },
                    { user: 'DiceKing', message: 'Anyone going for the jackpot?' },
                    { user: 'Admin', message: 'Referral bonus increased to â‚¦500!' }
                ];
                chatMessages.innerHTML = '';
                savedMessages.forEach(msg => {
                    appendChatMessage(msg.user, msg.message);
                });
            }
            
            // Function to append a new chat message
            function appendChatMessage(user, message) {
                const msgElement = document.createElement('p');
                const isCurrentUser = currentUser && user === currentUser.username;
                msgElement.innerHTML = `<strong style="${isCurrentUser ? 'color: #27AE60;' : ''}">${user}:</strong> ${message}`;
                chatMessages.appendChild(msgElement);
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                // Save to localStorage
                const savedMessages = JSON.parse(localStorage.getItem('chatMessages')) || [
                    { user: 'LuckyPlayer', message: 'Just won 5000!' },
                    { user: 'DiceKing', message: 'Anyone going for the jackpot?' },
                    { user: 'Admin', message: 'Referral bonus increased to â‚¦500!' }
                ];
                savedMessages.push({ user, message });
                // Keep only the last 50 messages
                if (savedMessages.length > 50) {
                    savedMessages.shift();
                }
                localStorage.setItem('chatMessages', JSON.stringify(savedMessages));
            }
            
            // Send chat message
            function sendChatMessage() {
                if (!currentUser) {
                    showCustomPopup('Please log in to chat');
                    return;
                }
                
                const message = chatInput.value.trim();
                if (message) {
                    appendChatMessage(currentUser.username, message);
                    chatInput.value = '';
                }
            }
            
            // Chat event listeners
            chatSendBtn.addEventListener('click', sendChatMessage);
            chatInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendChatMessage();
                }
            });
            
            // Initialize chat when page loads
            initializeChat();
            
            // Update leaderboard periodically
            setInterval(updateLeaderboard, 300000); // Updates every 5 minutes
        });
    </script>
</body>
